import{r as t,a as p,j as e}from"./app-CQPZVfaW.js";import E from"./StatusModal-3moMTwcl.js";const T=({show:d,onClose:h})=>{const[u,g]=t.useState([]),[v,o]=t.useState(!0),[j,y]=t.useState(null),[a,m]=t.useState(null),[c,w]=t.useState(""),[l,f]=t.useState(!1),[C,i]=t.useState(!1),[r,b]=t.useState(null),[n,x]=t.useState({show:!1,isSuccess:!1,title:"",message:""});t.useEffect(()=>{d&&S()},[d]);const S=async()=>{try{o(!0);const s=await p.get("/admin/contact-messages");g(s.data),o(!1)}catch{y("Failed to fetch messages. Please try again later."),o(!1)}},k=s=>{m(s)},D=()=>{m(null)},M=s=>{b(s),i(!0)},L=async()=>{if(r)try{f(!0),await p.delete(`/admin/contact-messages/${r.id}`),g(u.filter(s=>s.id!==r.id)),a&&a.id===r.id&&m(null),x({show:!0,isSuccess:!0,title:"Success",message:"Message deleted successfully"})}catch{x({show:!0,isSuccess:!1,title:"Error",message:"Failed to delete message. Please try again."})}finally{f(!1),i(!1),b(null)}},N=u.filter(s=>s.name.toLowerCase().includes(c.toLowerCase())||s.email.toLowerCase().includes(c.toLowerCase())||s.message.toLowerCase().includes(c.toLowerCase()));return d?e.jsxs(e.Fragment,{children:[e.jsx(E,{show:n.show,onHide:()=>x({...n,show:!1}),isSuccess:n.isSuccess,title:n.title,message:n.message}),C&&e.jsx("div",{className:"modal fade show",style:{display:"block",backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:1060},onClick:()=>i(!1),children:e.jsx("div",{className:"modal-dialog modal-dialog-centered",onClick:s=>s.stopPropagation(),children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title",children:"Confirm Delete"}),e.jsx("button",{type:"button",className:"btn-close",onClick:()=>i(!1)})]}),e.jsx("div",{className:"modal-body",children:e.jsx("p",{children:"Are you sure you want to delete this message? This action cannot be undone."})}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>i(!1),disabled:l,children:"Cancel"}),e.jsx("button",{type:"button",className:"btn btn-danger",onClick:L,disabled:l,children:l?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}),e.jsx("span",{className:"ms-2",children:"Deleting..."})]}):"Delete"})]})]})})}),e.jsx("div",{className:"modal fade show",style:{display:"block",backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:1050},onClick:h,children:e.jsx("div",{className:"modal-dialog modal-dialog-centered modal-lg",onClick:s=>s.stopPropagation(),children:e.jsxs("div",{className:"modal-content",style:{height:"75vh"},children:[e.jsx("div",{className:"modal-header border-bottom-0",children:e.jsxs("div",{className:"d-flex align-items-center w-100",children:[a&&e.jsx("button",{className:"btn btn-link me-2 p-0",onClick:D,children:e.jsx("i",{className:"bi bi-arrow-left fs-4"})}),e.jsx("h5",{className:"modal-title mb-0 flex-grow-1",children:"Landing Page Messages"}),e.jsx("button",{type:"button",className:"btn-close",onClick:h})]})}),e.jsx("div",{className:"modal-body p-0 d-flex flex-column",children:v?e.jsx("div",{className:"d-flex justify-content-center align-items-center h-100",children:e.jsx("div",{className:"spinner-border text-primary",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})})}):j?e.jsx("div",{className:"alert alert-danger m-3",children:j}):a?e.jsxs("div",{className:"d-flex flex-column h-100",children:[e.jsxs("div",{className:"p-3 border-bottom d-flex justify-content-between align-items-center",children:[e.jsx("div",{className:"d-flex align-items-center",children:e.jsxs("div",{className:"flex-grow-1 ms-3 text-start",children:[e.jsx("h5",{className:"mb-0",children:a.name}),e.jsx("small",{className:"text-muted",children:a.email})]})}),e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("small",{className:"text-muted me-3",children:new Date(a.created_at).toLocaleString()}),e.jsx("button",{className:"btn btn-outline-danger btn-sm",onClick:()=>M(a),disabled:l,children:l?e.jsx("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}):e.jsx("i",{className:"bi bi-trash"})})]})]}),e.jsx("div",{className:"overflow-auto",style:{maxHeight:"50vh",overflowY:"auto"},children:e.jsx("div",{className:"d-flex justify-content-start mb-3",children:e.jsxs("div",{className:"bg-white rounded-3 p-3 shadow-sm position-relative",style:{maxWidth:"80%"},children:[e.jsx("p",{className:"mb-0",children:a.message}),e.jsx("div",{className:"text-end mt-2",children:e.jsx("small",{className:"text-muted",children:new Date(a.created_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})})]})})})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"px-3 pb-2",children:e.jsxs("div",{className:"input-group",children:[e.jsx("span",{className:"input-group-text bg-white",children:e.jsx("i",{className:"bi bi-search"})}),e.jsx("input",{type:"text",className:"form-control",placeholder:"Search messages...",value:c,onChange:s=>w(s.target.value)})]})}),e.jsx("div",{className:"overflow-auto",style:{maxHeight:"55vh",overflowY:"auto"},children:N.length===0?e.jsxs("div",{className:"text-center py-5",children:[e.jsx("i",{className:"bi bi-envelope-open fs-1 text-muted"}),e.jsx("p",{className:"mt-2",children:"No messages found"})]}):e.jsx("div",{className:"list-group list-group-flush",children:N.map(s=>e.jsx("div",{className:`list-group-item list-group-item-action border-0 d-flex justify-content-between align-items-center ${(a==null?void 0:a.id)===s.id?"bg-light":""}`,children:e.jsxs("div",{className:"flex-grow-1 d-flex align-items-center",style:{cursor:"pointer"},onClick:()=>k(s),children:[e.jsx("div",{className:"me-3",children:e.jsx("div",{className:"bg-primary text-white rounded-circle d-flex align-items-center justify-content-center",style:{width:"40px",height:"40px"},children:s.name.charAt(0).toUpperCase()})}),e.jsxs("div",{className:"flex-grow-1",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsx("h6",{className:"mb-0",children:s.name}),e.jsx("small",{className:"text-muted",children:new Date(s.created_at).toLocaleDateString()})]}),e.jsx("p",{className:"mb-0 text-muted text-truncate",style:{maxWidth:"400px",textAlign:"left"},children:s.message})]})]})},s.id))})})]})})]})})})]}):null};export{T as default};
