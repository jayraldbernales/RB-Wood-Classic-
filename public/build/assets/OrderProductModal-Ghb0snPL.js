import{r as t,j as e,m as $e,S as ce}from"./app-CupyZw7M.js";import Oe from"./StatusModal-DBJz2I3d.js";import{a as Le,b as Pe,c as ie,t as _e,T as We,d as Fe,M as oe}from"./Modal--PeoWE0q.js";import{u as He,A as ue}from"./Anchor-ZDNIgdw2.js";import{u as B,c as _,a as Xe}from"./divWithClassName-Cl_CX82P.js";import{f as ze,m as de}from"./ElementChildren-CtHcYK4n.js";import"./index-4SsW87ZX.js";import"./Button-CpivXETG.js";function Qe(n,a){const c=t.useRef(!0);t.useEffect(()=>{if(c.current){c.current=!1;return}return n()},a)}function Ue(){const n=t.useRef(!0),a=t.useRef(()=>n.current);return t.useEffect(()=>(n.current=!0,()=>{n.current=!1}),[]),a.current}const q=2**31-1;function fe(n,a,c){const u=c-Date.now();n.current=u<=q?setTimeout(a,u):setTimeout(()=>fe(n,a,c),q)}function qe(){const n=Ue(),a=t.useRef();return Le(()=>clearTimeout(a.current)),t.useMemo(()=>{const c=()=>clearTimeout(a.current);function u(m,o=0){n()&&(c(),o<=q?a.current=setTimeout(m,o):fe(a,m,Date.now()+o))}return{set:u,clear:c,handleRef:a}},[])}const he=t.forwardRef(({className:n,bsPrefix:a,as:c="div",...u},m)=>(a=B(a,"carousel-caption"),e.jsx(c,{ref:m,className:_(n,a),...u})));he.displayName="CarouselCaption";const xe=t.forwardRef(({as:n="div",bsPrefix:a,className:c,...u},m)=>{const o=_(c,B(a,"carousel-item"));return e.jsx(n,{ref:m,...u,className:o})});xe.displayName="CarouselItem";const Be=40;function Ke(n){if(!n||!n.style||!n.parentNode||!n.parentNode.style)return!1;const a=getComputedStyle(n);return a.display!=="none"&&a.visibility!=="hidden"&&getComputedStyle(n.parentNode).display!=="none"}const pe=t.forwardRef(({defaultActiveIndex:n=0,...a},c)=>{const{as:u="div",bsPrefix:m,slide:o=!0,fade:f=!1,controls:A=!0,indicators:y=!0,indicatorLabels:$=[],activeIndex:d,onSelect:h,onSlide:b,onSlid:S,interval:C=5e3,keyboard:W=!0,onKeyDown:O,pause:v="hover",onMouseOver:L,onMouseOut:I,wrap:g=!0,touch:l=!0,onTouchStart:w,onTouchMove:R,onTouchEnd:X,prevIcon:be=e.jsx("span",{"aria-hidden":"true",className:"carousel-control-prev-icon"}),prevLabel:K="Previous",nextIcon:Ne=e.jsx("span",{"aria-hidden":"true",className:"carousel-control-next-icon"}),nextLabel:V="Next",variant:Y,className:je,children:z,...ve}=He({defaultActiveIndex:n,...a},{activeIndex:"onSelect"}),N=B(m,"carousel"),T=Xe(),M=t.useRef(null),[G,J]=t.useState("next"),[ge,F]=t.useState(!1),[D,Z]=t.useState(!1),[i,ye]=t.useState(d||0);t.useEffect(()=>{!D&&d!==i&&(M.current?J(M.current):J((d||0)>i?"next":"prev"),o&&Z(!0),ye(d||0))},[d,D,i,o]),t.useEffect(()=>{M.current&&(M.current=null)});let k=0,ee;ze(z,(s,r)=>{++k,r===d&&(ee=s.props.interval)});const se=Pe(ee),x=t.useCallback(s=>{if(D)return;let r=i-1;if(r<0){if(!g)return;r=k-1}M.current="prev",h==null||h(r,s)},[D,i,h,g,k]),p=ie(s=>{if(D)return;let r=i+1;if(r>=k){if(!g)return;r=0}M.current="next",h==null||h(r,s)}),Q=t.useRef();t.useImperativeHandle(c,()=>({element:Q.current,prev:x,next:p}));const te=ie(()=>{!document.hidden&&Ke(Q.current)&&(T?x():p())}),E=G==="next"?"start":"end";Qe(()=>{o||(b==null||b(i,E),S==null||S(i,E))},[i]);const Se=`${N}-item-${G}`,Ce=`${N}-item-${E}`,we=t.useCallback(s=>{_e(s),b==null||b(i,E)},[b,i,E]),ke=t.useCallback(()=>{Z(!1),S==null||S(i,E)},[S,i,E]),Ee=t.useCallback(s=>{if(W&&!/input|textarea/i.test(s.target.tagName))switch(s.key){case"ArrowLeft":s.preventDefault(),T?p(s):x(s);return;case"ArrowRight":s.preventDefault(),T?x(s):p(s);return}O==null||O(s)},[W,O,x,p,T]),Ie=t.useCallback(s=>{v==="hover"&&F(!0),L==null||L(s)},[v,L]),Re=t.useCallback(s=>{F(!1),I==null||I(s)},[I]),ne=t.useRef(0),H=t.useRef(0),re=qe(),Te=t.useCallback(s=>{ne.current=s.touches[0].clientX,H.current=0,v==="hover"&&F(!0),w==null||w(s)},[v,w]),Me=t.useCallback(s=>{s.touches&&s.touches.length>1?H.current=0:H.current=s.touches[0].clientX-ne.current,R==null||R(s)},[R]),De=t.useCallback(s=>{if(l){const r=H.current;Math.abs(r)>Be&&(r>0?x(s):p(s))}v==="hover"&&re.set(()=>{F(!1)},C||void 0),X==null||X(s)},[l,v,x,p,re,C,X]),ae=C!=null&&!ge&&!D,U=t.useRef();t.useEffect(()=>{var s,r;if(!ae)return;const j=T?x:p;return U.current=window.setInterval(document.visibilityState?te:j,(s=(r=se.current)!=null?r:C)!=null?s:void 0),()=>{U.current!==null&&clearInterval(U.current)}},[ae,x,p,se,C,te,T]);const le=t.useMemo(()=>y&&Array.from({length:k},(s,r)=>j=>{h==null||h(r,j)}),[y,k,h]);return e.jsxs(u,{ref:Q,...ve,onKeyDown:Ee,onMouseOver:Ie,onMouseOut:Re,onTouchStart:Te,onTouchMove:Me,onTouchEnd:De,className:_(je,N,o&&"slide",f&&`${N}-fade`,Y&&`${N}-${Y}`),children:[y&&e.jsx("div",{className:`${N}-indicators`,children:de(z,(s,r)=>e.jsx("button",{type:"button","data-bs-target":"","aria-label":$!=null&&$.length?$[r]:`Slide ${r+1}`,className:r===i?"active":void 0,onClick:le?le[r]:void 0,"aria-current":r===i},r))}),e.jsx("div",{className:`${N}-inner`,children:de(z,(s,r)=>{const j=r===i;return o?e.jsx(We,{in:j,onEnter:j?we:void 0,onEntered:j?ke:void 0,addEndListener:Fe,children:(P,Ae)=>t.cloneElement(s,{...Ae,className:_(s.props.className,j&&P!=="entered"&&Se,(P==="entered"||P==="exiting")&&"active",(P==="entering"||P==="exiting")&&Ce)})}):t.cloneElement(s,{className:_(s.props.className,j&&"active")})})}),A&&e.jsxs(e.Fragment,{children:[(g||d!==0)&&e.jsxs(ue,{className:`${N}-control-prev`,onClick:x,children:[be,K&&e.jsx("span",{className:"visually-hidden",children:K})]}),(g||d!==k-1)&&e.jsxs(ue,{className:`${N}-control-next`,onClick:p,children:[Ne,V&&e.jsx("span",{className:"visually-hidden",children:V})]})]})]})});pe.displayName="Carousel";const me=Object.assign(pe,{Caption:he,Item:xe}),ns=({product:n,show:a,onHide:c,showStatusModal:u})=>{var I,g;const[m,o]=t.useState(0),[f,A]=t.useState(1),[y,$]=t.useState(null),[d,h]=t.useState({show:!1,isSuccess:!1,title:"",message:""}),{processing:b,setData:S}=$e({product_id:n.id,quantity:f,action:null});t.useEffect(()=>{S("quantity",f)},[f]),t.useEffect(()=>()=>{A(1),$(null),o(0)},[]);const C=l=>o(l),W=l=>{ce.post("/cart",{product_id:n.id,quantity:f},{preserveScroll:!0,onSuccess:()=>{c(),setTimeout(()=>{u(!0,"Success!","Item added to cart successfully!")},100),setTimeout(()=>{window.location.reload()},200)},onError:()=>{u(!1,"Error!","Failed to add item to cart. Please try again.")}})},O=l=>l.url?l.url:l.image?`/storage/${l.image}`:"/placeholder-image.jpg",v=()=>A(l=>Math.min(20,l+1)),L=()=>A(l=>Math.max(1,l-1));return e.jsxs(e.Fragment,{children:[e.jsx(Oe,{show:d.show,onHide:()=>h(l=>({...l,show:!1})),isSuccess:d.isSuccess,title:d.title,message:d.message}),e.jsx(oe,{show:a,onHide:c,size:"lg",centered:!0,children:e.jsx(oe.Body,{className:"p-4",children:e.jsxs("div",{className:"row g-4 align-items-center",children:[e.jsx("div",{className:"col-md-6",children:e.jsx("div",{className:"p-3 bg-white shadow-sm rounded",children:((I=n.images)==null?void 0:I.length)>0?e.jsx(me,{activeIndex:m,onSelect:C,interval:null,className:"rounded",prevIcon:e.jsx("span",{className:"text-secondary",style:{fontSize:"2rem"},children:"‹"}),nextIcon:e.jsx("span",{className:"text-secondary",style:{fontSize:"2rem"},children:"›"}),children:(g=n.images)==null?void 0:g.map((l,w)=>e.jsx(me.Item,{children:e.jsx("img",{className:"d-block w-100 rounded",src:O(l),alt:`${n.name} - ${w+1}`,style:{height:"380px",objectFit:"cover"},onError:R=>{R.target.onerror=null,R.target.src="/placeholder-image.jpg"}})},w))}):e.jsx("div",{className:"d-flex align-items-center justify-content-center bg-light rounded",style:{height:"380px"},children:e.jsx("span",{children:"No Image Available"})})})}),e.jsxs("div",{className:"col-md-6 d-flex flex-column",children:[e.jsxs("div",{className:"flex-grow-1",children:[e.jsx("h2",{className:"fw-bold text-dark mb-3",children:n.name}),e.jsx("div",{className:"mb-4",children:e.jsxs("h3",{className:"text-dark mb-0",children:["₱",Number(n.price).toLocaleString("en-PH")]})}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"form-label fw-bold d-block mb-2",children:"Description"}),n.description&&e.jsx("p",{className:"text-muted mb-0",children:n.description})]}),n.dimensions&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h6",{className:"fw-semibold text-secondary mb-2",children:"Dimensions"}),e.jsx("p",{className:"text-dark mb-0",children:n.dimensions})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"form-label fw-semibold text-secondary d-block mb-1 small",children:"Quantity"}),e.jsxs("div",{className:"d-flex align-items-center",style:{maxWidth:"120px"},children:[e.jsx("button",{type:"button",className:"btn btn-outline-secondary px-2 py-1",onClick:L,disabled:f<=1,style:{minWidth:"32px"},children:e.jsx("i",{className:"bi bi-dash-lg"})}),e.jsx("input",{type:"text",className:"form-control text-center mx-1 py-1",value:f,readOnly:!0,style:{width:"40px",borderRadius:"6px",fontWeight:"bold",fontSize:"0.9rem"}}),e.jsx("button",{type:"button",className:"btn btn-outline-secondary px-2 py-1",onClick:v,disabled:f>=20,style:{minWidth:"32px"},children:e.jsx("i",{className:"bi bi-plus-lg"})})]})]}),e.jsxs("div",{className:"d-flex gap-3 mb-3",children:[e.jsxs("button",{className:"btn btn-outline-dark flex-grow-1 py-3",onClick:()=>W(),disabled:b&&y==="cart",children:[b&&y==="cart"?e.jsx("span",{className:"spinner-border spinner-border-sm me-2"}):e.jsx("i",{className:"bi bi-cart-plus me-2"}),b&&y==="cart"?"Adding...":"Add to Cart"]}),e.jsxs("button",{className:"btn btn-dark flex-grow-1 py-3",onClick:()=>{ce.visit(route("checkout.product.show",{product:n.id,quantity:f}))},children:[e.jsx("i",{className:"bi bi-bag-check me-2"}),"Place Order"]})]}),e.jsx("div",{className:"text-center",children:e.jsxs("small",{className:"text-muted",children:["Have questions?"," ",e.jsx("a",{href:"https://m.me/647746091735906",target:"_blank",rel:"noopener noreferrer",className:"text-secondary fw-bold",children:"Message us"})]})})]})]})})})]})};export{ns as default};
